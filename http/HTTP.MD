# HTTP 超文本传输协议

## TCP/IP 协议族

计算机与网络设备要相互通信，双方就必须基于相同的方法。比如，
如何探测到通信目标、由哪一边先发起通信、使用哪种语言进行通
信、怎样结束通信等规则都需要事先确定。不同的硬件、操作系统之
间的通信，所有的这一切都需要一种规则。而我们就把这种规则称为
协议（protocol）

TCP/IP 分为 4 层： 应用层、传输层、网络层和数据链路层

### 应用层

### 传输层

### 网络层

### 数据链路层

### IP 协议

IP 协议的作用是把各种数据包传送给对方。而要保证确实传送到对方
那里，则需要满足各类条件。其中两个重要的条件是 IP 地址和 MAC
地址（Media Access Control Address）。

### TCP 协议

TCP 位于传输层，提供可靠的字节流服务

用 TCP 协议把数据包送出去后，TCP
不会对传送后的情况置之不理，它一定会向对方确认是否成功送达。
握手过程中使用了 TCP 的标志（flag） —— SYN（synchronize） 和
ACK（acknowledgement）。

## HTTP 请求报文

HTTP 报文由：方法 - URI - HTTP 协议版本 - HTTP 首部字段

请求行：方法 - URI - HTTP 协议版本

HTTP 首部字段： 请求首部字段 - 通用首部字段 - 实体首部字段

## HTTP 响应报文

HTTP 报文由：HTTP 协议版本 - 状态妈 - 原因短语

请求行：HTTP 协议版本 - 状态码

HTTP 首部字段： 响应首部字段 - 通用首部字段 - 实体首部字段

## 通用首部字段

- Cache-Control 控制缓存的行为
- Connection 逐跳首部、连接的管理
- Date 创建报文的日期时间
- Pragma 报文指令
- Trailer 报文末端的首部一览
- Transfer-Encoding 指定报文主体的传输编码方式
- Upgrade 升级为其他协议
- Via 代理服务器的相关信息
- Warning 错误通知

## 请求首部字段

- Accept 用户代理可处理的媒体类型
- Accept-Charset 优先的字符集
- Accept-Encoding 优先的内容编码
- Accept-Language 优先的语言（自然语言）
- Authorization Web 认证信息
- Expect 期待服务器的特定行为
- From 用户的电子邮箱地址
- Host 请求资源所在服务器
- If-Match 比较实体标记（ETag）
- If-Modified-Since 比较资源的更新时间
- If-None-Match 比较实体标记（与 If-Match 相反）
- If-Range 资源未更新时发送实体 Byte 的范围请求
- If-Unmodified-Since 比较资源的更新时间（与 If-Modified-Since 相反）
- Max-Forwards 最大传输逐跳数
- Proxy-Authorization 代理服务器要求客户端的认证信息
- Range 实体的字节范围请求
- Referer 对请求中 URI 的原始获取方
- TE 传输编码的优先级
- User-Agent HTTP 客户端程序的信息

## 响应首部字段

## 实体首部字段

## 状态码

1XX 请求正在处理

2XX 请求处理完毕

- 200 成功
- 204 返回结果没有 content 页面不需要跟新
- 206 请求有范围限制 content-range

3XX 需要附加操作完成请求

- 301 永久性重定向 uri 已经更新
- 302 临时性重定向
- 303 和 302 功能相同 但是仅限于 GET 请求
- 304 附带条件请求，但是为满足请求条件
- 307 和 302 相同，但是不会禁止 POST 请求

4XX 客服端错误

- 400 bad request
- 401 请求未通过认证
- 403 服务器拒绝请求
- 404 not found

5XX 服务端错误

- 500 服务器内部崩溃
- 503 服务器当前不可用

## 内容资源策略

作用

- 限制资源获取
- 通知服务获取资源越权

## 代理

> 代理是一种有转发功能的应用程序，它扮演了位于服务器和客户
> 端“中间人”的角色，接收由客户端发送的请求并转发给服务器，同时
> 也接收服务器返回的响应并转发给客户端。

> 代理服务器的基本行为就是接收客户端发送的请求后转发给其他服务
> 器。代理不改变请求 URI，会直接发送给前方持有资源的目标服务
> 器。

缓存代理

> 代理转发响应时，缓存代理（Caching Proxy）会预先将资源的副本
> （缓存）保存在代理服务器上。

透明代理

> 转发请求或响应时，不对报文做任何加工的代理类型被称为透明代理
> （Transparent Proxy）。反之，对报文内容进行加工的代理被称为非
> 透明代理。

## 网关

利用网关，利用网关可以由 HTTP 请求转化为其他协议通信

客户端 - 网关 - 非 HTTP 服务器哦

利用网关能提高通信的安全性，因为可以在客户端与网关之间的通信
线路上加密以确保连接的安全。比如，网关可以连接数据库，使用
SQL 语句查询数据。另外，在 Web 购物网站上进行信用卡结算时，
网关可以和信用卡结算系统联动。

> 网关是转发其他服务器通信数据的服务器，接收从客户端发送来的请
> 求时，它就像自己拥有资源的源服务器一样对请求进行处理。有时客
> 户端可能都不会察觉，自己的通信目标是一个网关。

## 隧道

隧道可按要求建立起一条与其他服务器的通信线路，届时使用 SSL 等
加密手段进行通信。隧道的目的是确保客户端能与服务器进行安全的
通信。

客户端 - 隧道 - 服务器

隧道本身是透明的，客户端不用在意隧道是否存在

> 隧道是在相隔甚远的客户端和服务器两者之间进行中转，并保持双方
> 通信连接的应用程序。
